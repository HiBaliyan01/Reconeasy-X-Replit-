{
"updates": [
{
"pattern": ".*",
"replacement": "// ✅ CLAIMS TRACKER TABLE FIXES + ENHANCEMENTS\n\n// --- COMPONENT: ClaimsTracker.tsx (Main Page Table View) ---\n\nimport React, { useEffect, useState } from 'react';\nimport { getClaims, updateClaimStatus, sendReminder, downloadClaimsPDF, downloadClaimsExcel } from '@/lib/api';\nimport { Claim } from '@/types';\nimport { Badge } from '@/components/ui/badge';\nimport { Tooltip } from '@/components/ui/tooltip';\nimport { Button } from '@/components/ui/button';\nimport ClaimDetailsDrawer from './ClaimDetailsDrawer';\n\nexport default function ClaimsTracker() {\n const [claims, setClaims] = useState<Claim[]>([]);\n const [filteredClaims, setFilteredClaims] = useState<Claim[]>([]);\n const [selectedClaims, setSelectedClaims] = useState<string[]>([]);\n const [claimType, setClaimType] = useState<'payment' | 'return'>('payment');\n const [bulkStatus, setBulkStatus] = useState('');\n\n useEffect(() => {\n getClaims().then((data) => {\n setClaims(data);\n setFilteredClaims(data.filter((c) => c.type === claimType));\n });\n }, []);\n\n useEffect(() => {\n setFilteredClaims(claims.filter((c) => c.type === claimType));\n }, [claimType, claims]);\n\n const handleSelectClaim = (id: string) => {\n setSelectedClaims((prev) =>\n prev.includes(id) ? prev.filter((cid) => cid !== id) : [...prev, id]\n );\n };\n\n const handleBulkStatusUpdate = async () => {\n await Promise.all(\n selectedClaims.map((id) => updateClaimStatus(id, bulkStatus))\n );\n const updated = await getClaims();\n setClaims(updated);\n };\n\n const handleReminder = async () => {\n await Promise.all(selectedClaims.map((id) => sendReminder(id)));\n alert('Reminder sent!');\n };\n\n return (\n <div className="px-6 py-4">\n <div className="flex justify-between items-center mb-4">\n <h2 className="text-2xl font-bold">📑 Claims Tracker</h2>\n <div className="flex space-x-2">\n <Button variant="outline" onClick={downloadClaimsExcel}>📊 Excel</Button>\n <Button variant="outline" onClick={downloadClaimsPDF}>📄 PDF</Button>\n </div>\n </div>\n\n <div className="flex space-x-6 items-center mb-3">\n <Button\n variant={claimType === 'return' ? 'default' : 'ghost'}\n onClick={() => setClaimType('return')}\n >\n Returns Claims\n </Button>\n <Button\n variant={claimType === 'payment' ? 'default' : 'ghost'}\n onClick={() => setClaimType('payment')}\n >\n Payment Claims\n </Button>\n\n <div className="ml-auto flex space-x-2">\n <select\n value={bulkStatus}\n onChange={(e) => setBulkStatus(e.target.value)}\n className="border rounded px-2 py-1"\n >\n <option value="">Update Status</option>\n <option value="pending">Pending</option>\n <option value="resolved">Resolved</option>\n <option value="in_progress">In Progress</option>\n <option value="rejected">Rejected</option>\n </select>\n <Button onClick={handleBulkStatusUpdate}>Update</Button>\n <Button variant="outline" onClick={handleReminder}>🔔 Send Reminder</Button>\n </div>\n </div>\n\n <table className="w-full text-sm border rounded-md">\n <thead className="bg-gray-100 sticky top-0">\n <tr>\n <th className="w-[32px] px-2">✔</th>\n <th>Order ID</th>\n <th>Marketplace</th>\n <th>Claim Type</th>\n <th>Status</th>\n <th>Last Updated</th>\n <th>Aging</th>\n </tr>\n </thead>\n <tbody>\n {filteredClaims.map((claim) => (\n <tr\n key={claim.id}\n className={border-b hover:bg-blue-50 transition ${ selectedClaims.includes(claim.id) ? 'bg-blue-50' : '' }}\n >\n <td className="px-2">\n <input\n type="checkbox"\n checked={selectedClaims.includes(claim.id)}\n onChange={() => handleSelectClaim(claim.id)}\n />\n </td>\n <td>\n <a\n href={/claims/${claim.id}}\n className="text-blue-600 underline cursor-pointer"\n >\n {claim.orderId}\n </a>\n </td>\n <td>{claim.marketplace}</td>\n <td>{claim.issue}</td>\n <td>\n <Badge variant={\n claim.status === 'resolved' ? 'success' :\n claim.status === 'rejected' ? 'destructive' :\n claim.status === 'in_progress' ? 'secondary' :\n 'outline'}\n >\n {claim.status.replaceAll('_', ' ')}\n </Badge>\n </td>\n <td>{claim.updatedAt}</td>\n <td className={${claim.aging > 15 ? 'text-red-500' : claim.aging > 7 ? 'text-orange-500' : ''}}>\n {claim.aging} days\n {claim.aging > 7 && (\n <Tooltip content="Consider following up with marketplace">\n <span className="ml-1">⚠️</span>\n </Tooltip>\n )}\n </td>\n </tr>\n ))}\n </tbody>\n </table>\n </div>\n );\n}\n\n// ⏳ Follow-up: Add ClaimDetailsDrawer.tsx with snapshot, status, and comment fix in next phase\n// ✨ Integrate column sorting, inline help, and improved modals via HeadlessUI/Dialog in final sweep\n"
}
]
}